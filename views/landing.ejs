 <%- include ("partials/header") %>

 <!--Banner-->
<div class="banner">
  <div class="bg-color">
    <div class="container">
      <div class="row">
        <div class="banner-text text-center">
          <div class="text-border">
            <h2 class="text-dec">Terrassa al Dia</h2>
          </div>
          <div class="intro-para text-center quote">
            <p class="big-text">Dades COVID Actualitzades</p>
            <p class="small-text">Aquí trobaràs totes les dades COVID referents a la ciutat de Terrassa.<br>Són les dades oficials que publica la Generalitat a través de la seva API oberta.</p>
            <a href="#organisations" class="btn get-quote">Explora</a>
          </div>
          <a href="#cta-2" class="mouse-hover">
            <div class="mouse"></div>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
<!--/ Banner-->

<!--Cerca-->
<section id="cta-2">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h2 class="text-center">Cerca Específica per Data</h2>
          <p class="cta-2-txt">Introdueix una data per a obtenir les dades referents a aquell registre.</p>
          <div class="cta-2-form text-center">
            <form action="" method="GET" id="workshop-newsletter-form">
              <input name="data" placeholder="DD-MM-AAAA">
              <input class="cta-2-form-submit-btn" value="Cerca" type="submit">
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!--/ Cerca-->

<!--Dades-->
<section id="organisations" class="section-padding">
  <div class="container">
    <div class="row">
      <div class="col-md-8">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <div class="orga-stru">
            <h3><%= totalPositiusHomes %></h3>
            <p>Positius</p>
            <i class="fa fa-male"></i>
          </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
            <div class="orga-stru">
              <h3><%= totalPositiusDones %></h3>
              <p>Positives</p>
              <i class="fa fa-female"></i>
            </div>
          </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
          <div class="orga-stru-yellow">
            <h3><%= totalSospitososHomes %></h3>
            <p>Sospitosos</p>
            <i class="fa fa-male"></i>
          </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
            <div class="orga-stru-yellow">
              <h3><%= totalSospitososDones %></h3>
              <p>Sospitoses</p>
              <i class="fa fa-female"></i>
            </div>
          </div>
      </div>
      <div class="col-md-4">
        <div class="detail-info">
          <hgroup>
            <h3 class="det-txt">Dades diàries sense acumular</h3>
            <h4 class="sm-txt">Data del Registre: <%= data%></h4>
          </hgroup>
          <p class="det-p"><b>Positius:</b> han donat positiu en alguna prova diagnòstica (PCR o test ràpid).</p>
          <p class="det-p"><b>Sospitosos:</b> han presentat símptomes i un professional sanitari els ha classificat com a possible cas, però no tenen prova diagnòstica.</p>
        </div>
      </div>
    </div>
  </div>
</section>
<!--/ Dades-->

<!--Gràfic-->
<section id="feature" class="section-padding">
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <div class="detail-info">
          <hgroup>
            <h3 class="det-txt">Registres de Casos per Dia</h3>
            <h4 class="sm-txt">(Secció en Construcció)</h4>
          </hgroup>
          <p class="det-p"><b>Total Positius:</b> Sumatori de casos positius registrats d'homes i dones a Terrassa.</p>
          <p class="det-p"><b>Total Sospitosos:</b> Sumatori de casos sospitosos registrats d'homes i dones a Terrassa.</p>
        </div>
      </div>
      <div class="col-md-8">      
        <button class="btn" onclick="update(data1, color1)">Total Positius</button>
        <button class="btn" onclick="update(data2, color2)">Total Sospitosos</button>
        <div id="grafic"></div>
      </div>
    </div>
  </div>
</section>
<!--/ Gràfic-->

<!-- Gràfic Script-->
<script>

  //Total Positius
  var data1 = [
     /*{ser1: 1-May-12, ser2: 4},
     {ser1: 30-Apr-12, ser2: 16},
     {ser1: 27-Apr-12, ser2: 8},
     {ser1: 26-Apr-12, ser2: 12}*/
     
     {ser1: 5, ser2: 32, date: "1-Ag"},
     {ser1: 6, ser2: 16, date: "2-Ag"},
     {ser1: 7, ser2: 8, date: "3-Ag"},

     {ser1: 8, ser2: 12},
     {ser1: 9, ser2: 32},
     {ser1: 10, ser2: 16},
     {ser1: 11, ser2: 8},
     {ser1: 12, ser2: 12},
     {ser1: 13, ser2: 22},
     {ser1: 14, ser2: 6},
     {ser1: 15, ser2: 18},
     {ser1: 16, ser2: 32},
     {ser1: 17, ser2: 27},
     {ser1: 18, ser2: 13}
  ];
  
  //Total Sospitosos
  var data2 = [
     {ser1: 8, ser2: 7},
     {ser1: 9, ser2: 1},
     {ser1: 10, ser2: 7},
     {ser1: 11, ser2: 1},
     {ser1: 12, ser2: 7},
     {ser1: 13, ser2: 1},
     {ser1: 14, ser2: 7},
     {ser1: 15, ser2: 1},
     {ser1: 16, ser2: 7},
     {ser1: 17, ser2: 1},
     {ser1: 18, ser2: 8}
  ];

  //Colors línia gràfic
  var color1 = "#f04d43"; //vermell
  var color2= "#fdba13"; //taronja
  
  // Tamany i Marges del Gràfic
  var margin = {top: 10, right: 30, bottom: 30, left: 50},
      width = 700 - margin.left - margin.right,
      height = 400 - margin.top - margin.bottom;
  
  
  // append the svg object to the body of the page
  var svg = d3.select("#grafic")
    .append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
    .append("g")
      .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");
  
  // Initialise a X axis:
  var x = d3.scaleLinear().range([0,width]);
  var xAxis = d3.axisBottom().scale(x);
  svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .attr("class","myXaxis")
    .style("font-size", "12px")
    .style("font-family", "sans-serif")

    
    

  
  // Initialize an Y axis
  var y = d3.scaleLinear().range([height, 0]);
  var yAxis = d3.axisLeft().scale(y);
  svg.append("g")
    .attr("class","myYaxis")
    .style("font-size", "12px")
    .style("font-family", "sans-serif")
  
  // Create a function that takes a dataset as input and update the plot:
  function update(data, color) {
  
    // Create the X axis:
    x.domain([data[0].ser1, data[data.length - 1].ser1]);

    svg.selectAll(".myXaxis")
      .transition()
      .duration(3000)
      .call(xAxis)
      .selectAll("text")
      .style("text-anchor", "end")
      .attr("transform", "rotate(-65)");
  
    // create the Y axis
    y.domain([0, d3.max(data, function(d) {return d.ser2})+5]);
    svg.selectAll(".myYaxis")
      .transition()
      .duration(3000)
      .call(yAxis);
  
    // Create a update selection: bind to the new data
    var u = svg.selectAll(".lineTest")
      .data([data], function(d){ return d.ser1 });
  
    // Updata the line
    u
      .enter()
      .append("path")
      .attr("class","lineTest")
      .merge(u)
      .transition()
      .duration(3000)
      .attr("d", d3.line()
        .x(function(d) { return x(d.ser1); })
        .y(function(d) { return y(d.ser2); }))
        .attr("fill", "none")
        .attr("stroke", color)
        .attr("stroke-width", 2.5)
  }
  
  // At the beginning, I run the update function on the first dataset:
  update(data1, color1)
  
  </script>

<!-- Gràfic Script -->

<!--Projecte-->
<section id="organisations" class="section-padding">
    <div class="container">
      <div class="row">
        <div class="header-section text-center">
          <h2>Projecte</h2>
          <p>Aquest és un projecte sense ànim de lucre, amb l'objectiu de mantenir <br>els egarencs i les egarenques informats sobre l'estat del COVID-19 en relació a la ciutat. </p>
          <hr class="bottom-line">
        </div>
        <div class="feature-info">
          <div class="fea">
            <div class="col-md-4">
              <div class="heading pull-right">
                <h4>Codi Lliure</h4>
                <p>El codi és accessible per a tothom i pot ser re-utilitzat sota la llicència MIT. Fàcilment es pot fer la implementació per a d'altres municipis.</p>
              </div>
              <div class="fea-img pull-left">
                <i class="fa fa-css3"></i>
              </div>
            </div>
          </div>
          <div class="fea">
            <div class="col-md-4">
              <div class="heading pull-right">
                <h4>Dades Obertes</h4>
                <p>Aquest projecte es nutreix de l'API facilitada per la Generalitat de Catalunya i les dades provenen del registre RSAcovid19 del Dept. de Salut. </p>
              </div>
              <div class="fea-img pull-left">
                <i class="fa fa-drupal"></i>
              </div>
            </div>
          </div>
          <div class="fea">
            <div class="col-md-4">
              <div class="heading pull-right">
                <h4>Motivació</h4>
                <p>Aquest projecte és una iniciativa personal motivada per les ganes d'aportar el meu granet de sorra en la situació excepcional que estem vivint.</p>
              </div>
              <div class="fea-img pull-left">
                <i class="fa fa-trophy"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!--/ Projecte-->

<!--Footer-->
<footer id="footer" class="footer">
  <div class="container text-center">

    <h3>Contacte</h3>

     
<%- include ("partials/footer") %>